<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ä—Ç–∏–Ω–∫–∏ ‚Äî Dark Market Ultra</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: #eee;
            text-align: center;
            padding: 20px;
        }
        h1 {
            margin-bottom: 20px;
        }
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .image-card {
            background: #1c1c1c;
            padding: 15px;
            border-radius: 8px;
            transition: transform 0.2s ease-in-out;
        }
        .image-card:hover {
            transform: scale(1.05);
        }
        .image-card img {
            width: 100%;
            border-radius: 6px;
        }
        .price {
            color: crimson;
            font-weight: bold;
            margin: 8px 0;
        }
        button {
            background: crimson;
            border: none;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 6px;
        }
        button:hover {
            background: darkred;
        }
        #dev-panel {
            margin-top: 30px;
            padding: 20px;
            background: #1c1c1c;
            border-radius: 10px;
            display: none;
        }
        input, textarea {
            margin: 5px 0;
            padding: 8px;
            border-radius: 6px;
            border: none;
            width: 80%;
            background: #222;
            color: #eee;
        }
    </style>
</head>
<body>
    <header>
        <h1>–ö–∞—Ä—Ç–∏–Ω–∫–∏ ‚Äî Dark Market Ultra</h1>
        <nav>
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="home.html">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a>
      <a href="games.html">–ò–≥—Ä—ã</a>
      <a href="movies.html">–§–∏–ª—å–º—ã</a>
      <a href="music.html">–ú—É–∑—ã–∫–∞</a>
  <a href="images.html">–ö–∞—Ä—Ç–∏–Ω–∫–∏</a>
  <a href="books.html">–ö–Ω–∏–≥–∏</a>
      <a href="apps.html">–ü—Ä–æ–≥—Ä–∞–º–º—ã</a>
      <a href="tools.html">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</a>
        </nav>
        <p>–ü—Ä–µ–≤—å—é –±–µ—Å–ø–ª–∞—Ç–Ω—ã. –ü–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ üíé</p>
    </header>

    <main>
        <div class="gallery" id="gallery">
            <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏ -->
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ -->
        <section id="dev-panel">
            <h2>–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</h2>
            <input type="file" id="imageUpload" accept="image/*"><br>
            <input type="text" id="imageTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"><br>
            <input type="number" step="0.01" id="imagePrice" placeholder="–¶–µ–Ω–∞ (‚Ç¨)"><br>
            <button id="uploadImageBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        </section>
    </main>

    <footer>
        <p>¬© Dark Market Ultra ¬© 2025</p>
    </footer>

    <script src="config.js"></script>
    <script>
    document.addEventListener("DOMContentLoaded", async () => {
        const token = localStorage.getItem("token");

        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–∏–Ω–æ–∫
        try {
            const res = await fetch(`${API_URL}/images/list`);
            const data = await res.json();

            const gallery = document.getElementById("gallery");
            gallery.innerHTML = "";

            if (data.success && data.images.length > 0) {
                data.images.forEach(img => {
                    const div = document.createElement("div");
                    div.className = "image-card";
                    div.innerHTML = `
                        <img src="${API_URL + img.preview}" alt="${img.title}">
                        <p><b>${img.title}</b></p>
                        <p class="price">${img.price} ‚Ç¨</p>
                        <button onclick="buyImage(${img.id})">–ö—É–ø–∏—Ç—å</button>
                    `;
                    gallery.appendChild(div);
                });
            } else {
                gallery.innerHTML = "<p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç–∏–Ω–æ–∫.</p>";
            }
        } catch (err) {
            console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–æ–∫", err);
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–ª—å (–µ—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å)
        if (token) {
            try {
                const res = await fetch(`${API_URL}/profile`, {
                    headers: { Authorization: "Bearer " + token }
                });
                const user = await res.json();
                if (user.role === "admin" || user.subscription === "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫") {
                    document.getElementById("dev-panel").style.display = "block";
                }
            } catch {}
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
        document.getElementById("uploadImageBtn").addEventListener("click", async () => {
            const file = document.getElementById("imageUpload").files[0];
            const title = document.getElementById("imageTitle").value;
            const price = document.getElementById("imagePrice").value;

            if (!file || !price) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏ —É–∫–∞–∂–∏—Ç–µ —Ü–µ–Ω—É!");

            const formData = new FormData();
            formData.append("image", file);
            formData.append("title", title);
            formData.append("price", price);

            const res = await fetch(`${API_URL}/upload-image`, {
                method: "POST",
                headers: { Authorization: "Bearer " + token },
                body: formData
            });
            const result = await res.json();
            if (result.success) {
                alert("–ö–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!");
                location.reload();
            } else {
                alert("–û—à–∏–±–∫–∞: " + result.error);
            }
        });
    });

    // –ü–æ–∫—É–ø–∫–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏ (–∑–∞–≥–ª—É—à–∫–∞, –ø–æ–∑–∂–µ –ø–æ–¥–∫–ª—é—á–∏–º PayPal)
    async function buyImage(id) {
        const token = localStorage.getItem("token");
        if (!token) return alert("–í–æ–π–¥–∏—Ç–µ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!");
        alert("–ü–æ–∫—É–ø–∫–∞ —á–µ—Ä–µ–∑ PayPal –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –ø–æ–∑–∂–µ.");
    }

    // üö´ –ê–Ω—Ç–∏—Å–∫—Ä–∏–Ω—à–æ—Ç: –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –ø—Ä–∏ PrintScreen
    document.addEventListener("keydown", (e) => {
        if (e.key === "PrintScreen") {
            document.body.style.transition = "all 0.2s ease-in-out";
            document.body.style.filter = "brightness(0%)"; 
            setTimeout(() => {
                document.body.style.filter = "brightness(100%)";
            }, 2000);
            alert("–°–∫—Ä–∏–Ω—à–æ—Ç—ã –∑–∞–ø—Ä–µ—â–µ–Ω—ã!");
        }
        if (e.ctrlKey && (e.key === "c" || e.key === "s" || e.key === "p")) {
            e.preventDefault();
            alert("–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!");
        }
    });

    // üö´ –ó–∞–ø—Ä–µ—Ç –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–∏ –º—ã—à–∏
    document.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        alert("–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ!");
    });
    </script>
</body>
              </html>
