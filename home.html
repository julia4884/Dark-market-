<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî Dark Market Ultra</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #111;
            color: #eee;
            text-align: center;
            padding: 20px;
        }
        header, footer {
            margin-bottom: 20px;
        }
        #profile-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
        }
        section {
            background: #1c1c1c;
            padding: 20px;
            margin: 20px auto;
            border-radius: 10px;
            max-width: 500px;
        }
        button {
            background: crimson;
            border: none;
            color: white;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 6px;
        }
        button:hover {
            background: darkred;
        }
        textarea {
            width: 90%;
            height: 80px;
            resize: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Dark Market Ultra</h1>
        <h3>–¢—ë–º–Ω—ã–π —É–≥–æ–ª–æ–∫ —Å–≤–æ–±–æ–¥—ã</h3>
    </header>

    <main>
        <section id="user-info">
            <img id="profile-photo" src="default-avatar.png" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è">
            <h2 id="welcomeMessage">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
            <p><b>–ù–∏–∫–Ω–µ–π–º:</b> <span id="nickname">...</span></p>
            <p><b>–°—Ç–∞—Ç—É—Å:</b> <span id="status">...</span></p>
            <p><b>–ü–æ–¥–ø–∏—Å–∫–∞:</b> <span id="subscription">...</span></p>
            <input type="file" id="photoUpload" accept="image/*">
            <button id="savePhotoBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
            <hr>
            <h3>–û —Å–µ–±–µ</h3>
            <textarea id="aboutMe" placeholder="–ù–∞–ø–∏—à–∏ –æ —Å–µ–±–µ..."></textarea><br>
            <button id="saveAboutBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <hr>
            <button id="logoutBtn">üö™ –í—ã–π—Ç–∏</button>
        </section>
    </main>

    <footer>
        <p>¬© Dark Market Ultra ¬© 2025. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>
    </footer>

    <script src="config.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å backend
            try {
                const response = await fetch(`${API_URL}/profile`, {
                    method: "GET",
                    headers: { "Content-Type": "application/json" }
                });
                const user = await response.json();

                if (user.success) {
                    document.getElementById("welcomeMessage").innerText = 
                        `–ü—Ä–∏–≤–µ—Ç, ${user.username} üëã`;
                    document.getElementById("nickname").innerText = user.username;
                    document.getElementById("status").innerText = user.role;
                    document.getElementById("subscription").innerText = user.subscription ? "–ê–∫—Ç–∏–≤–Ω–∞ ‚úÖ" : "–ù–µ—Ç ‚ùå";
                    if (user.photo) {
                        document.getElementById("profile-photo").src = user.photo;
                    }
                    if (user.about) {
                        document.getElementById("aboutMe").value = user.about;
                    }
                } else {
                    alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≤—Ö–æ–¥.");
                    window.location.href = "index.html";
                }
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è:", error);
                window.location.href = "index.html";
            }

            // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
            document.getElementById("logoutBtn").addEventListener("click", () => {
                alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.");
                window.location.href = "index.html";
            });

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
            document.getElementById("savePhotoBtn").addEventListener("click", () => {
                const fileInput = document.getElementById("photoUpload");
                if (!fileInput.files[0]) return alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª!");
                alert("–§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∫ backend üì∏");
            });

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ '–û —Å–µ–±–µ'
            document.getElementById("saveAboutBtn").addEventListener("click", () => {
                const about = document.getElementById("aboutMe").value;
                alert(`–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ: ${about}`);
                // –ó–¥–µ—Å—å —Ç–æ–∂–µ –Ω—É–∂–µ–Ω POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ backend
            });
        });
    </script>
</body>
</html>
