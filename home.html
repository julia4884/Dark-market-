<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ‚Äî Dark Market Ultra</title>
  <link rel="stylesheet" href="style.css">
  <script defer src="script.js"></script>
</head>
<body>
  <header>
    <h1 class="logo">Dark Market Ultra</h1>
    <nav>
      <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="games.html">–ò–≥—Ä—ã</a>
      <a href="movies.html">–§–∏–ª—å–º—ã</a>
      <a href="music.html">–ú—É–∑—ã–∫–∞</a>
      <a href="images.html">–ö–∞—Ä—Ç–∏–Ω–∫–∏</a>
      <a href="books.html">–ö–Ω–∏–≥–∏</a>
      <a href="apps.html">–ü—Ä–æ–≥—Ä–∞–º–º—ã</a>
      <a href="tools.html">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</a>
      <a href="donate.html">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
      <a href="login.html" id="login-link">–í–æ–π—Ç–∏</a>
      <a href="#" id="logout-link" style="display:none;" onclick="logout()">–í—ã–π—Ç–∏</a>
    </nav>
  </header>

  <main>
    <section id="auth-guard" style="display:none;">
      <h2>–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h2>
      <div id="profile">
        <img id="profile-avatar" src="default-avatar.png" alt="–ê–≤–∞—Ç–∞—Ä" width="120">
        <p><strong>–ù–∏–∫:</strong> <span id="profile-username"></span> <span id="crown"></span></p>
        <p><strong>–†–æ–ª—å:</strong> <span id="profile-role"></span></p>
        <p><strong>–û —Å–µ–±–µ:</strong> <span id="profile-about"></span></p>
        
        <h3>–û–±–Ω–æ–≤–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</h3>
        <input type="file" id="avatar-input">
        <button id="avatar-upload-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <progress id="avatar-progress" max="100" value="0" style="display:none; width:100%;"></progress>

        <h3>–ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ</h3>
        <textarea id="about-text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –æ —Å–µ–±–µ..."></textarea>
        <button onclick="updateAbout(document.getElementById('about-text').value)">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>

      <hr>

      <h2>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h2>
      <input type="file" id="file-input">
      <select id="section-select">
        <option value="games">–ò–≥—Ä—ã</option>
        <option value="movies">–§–∏–ª—å–º—ã</option>
        <option value="music">–ú—É–∑—ã–∫–∞</option>
        <option value="images">–ö–∞—Ä—Ç–∏–Ω–∫–∏</option>
        <option value="books">–ö–Ω–∏–≥–∏</option>
        <option value="apps">–ü—Ä–æ–≥—Ä–∞–º–º—ã</option>
        <option value="tools">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</option>
      </select>
      <button id="upload-btn">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
      <progress id="upload-progress" value="0" max="100" style="display:none; width: 100%;"></progress>

      <hr>

      <h2>–ú–æ–∏ —Ñ–∞–π–ª—ã</h2>
      <div id="gallery" class="gallery"></div>

      <hr>

      <div id="admin-panel" style="display:none;">
        <h2>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
        <h3>–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <input type="text" id="block-user-id" placeholder="ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
        <input type="text" id="block-reason" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏">
        <button onclick="blockUser(document.getElementById('block-user-id').value, document.getElementById('block-reason').value)">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>

        <h3>–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</h3>
        <input type="text" id="block-file-id" placeholder="ID —Ñ–∞–π–ª–∞">
        <button onclick="blockApp(document.getElementById('block-file-id').value)">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
      </div>
    </section>

    <section id="unauth-guard">
      <h2>–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã</h2>
      <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="login.html">–≤–æ–π–¥–∏—Ç–µ</a> –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É.</p>
    </section>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const token = localStorage.getItem("token");
      if (token) {
        document.getElementById("auth-guard").style.display = "block";
        document.getElementById("unauth-guard").style.display = "none";
        document.getElementById("login-link").style.display = "none";
        document.getElementById("logout-link").style.display = "inline";
        loadProfile();

        if (localStorage.getItem("role") === "admin") {
          document.getElementById("admin-panel").style.display = "block";
          document.getElementById("crown").innerHTML = "üëë";
        }

        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞
        document.getElementById("avatar-upload-btn").onclick = () => {
          const file = document.getElementById("avatar-input").files[0];
          if (file) uploadAvatar(file);
        };
      } else {
        document.getElementById("auth-guard").style.display = "none";
        document.getElementById("unauth-guard").style.display = "block";
      }
    });

    function logout() {
      localStorage.removeItem("token");
      localStorage.removeItem("role");
      localStorage.removeItem("username");
      window.location.href = "index.html";
    }
  </script>
</body>
</html>
